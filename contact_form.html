<!DOCTYPE html>
<html>
	<head>
		  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
		  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
		  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
		  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
		  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
		  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		  <link rel="stylesheet" type="text/css" href="main.css">
		  <script>
			  $(function() {
				    $("#birthInput").datepicker({ 
						 dateFormat: 'yy-mm-dd'
					});
			  });
			  function submitData(){
				const form = document.getElementById("main_form");
				const phone = $('input[id="phoneInput"]').val();
				var re = /(?:\d{3}|\(\d{3}\))([-\/\.])\d{3}\1\d{4}/;  
				const validPhone = (phone) => {  
					var format = re.exec (phone); 
					if (!format) {
						return false; 
					}else{
						return true;
					} 
				}
				let count = 0;
				let totalInput = 0;
				$('input[required=true]').each(function(){
					totalInput = totalInput + 1;
					if($(this).val()!=""){
			   			count = count + 1;
					}
				 });
				//valida que todos los campos requeridos esten completos
				if(count == totalInput && validPhone(phone)){ 
					$.ajax({
						type: "POST",
						url: 'http://localhost/TestPhp/controller/insert.php',
						data: $(form).serialize(),
						dataType: 'text',
						success : function(res) {
							console.log(res)
							alert('form was submitted');
							window.location.href = "http://localhost/TestPhp/contact_list.php";
						}
				});
			}else{
				alert('favor de completar todos los campos requeridos!');
			}
		};
		 </script>
		<title>Test</title>
	</head>
	<body>

		<div class="d-flex justify-content-center">
			<h1>Add new contact</h1>
		</div>

		<div class="conteiner">
			<form id="main_form">

				<div class="form-group">
					<label for="nameInput">Name</label>
					<input 
						type="text"
						name="name" 
						class="form-control" 
						id="nameInput" 
						aria-describedby="emailHelp" 															
						placeholder="Enter your name"
				        required=true
					/>
				</div>


				<div class="form-group">
					<label for="datepicker">Birthday</label>
					<input 
						type="text" 
						name="birthday"
						class="form-control"
						id="birthInput"  
						autocomplete="off"
						placeholder="Pick a date" 
						required=true
					/>
				</div>

			

				<div class="form-group">
					<label for="exampleInputEmail1">Email address</label>
					<input 
						type="email"
						name="email" 
						class="form-control" 
						id="emailInput" 
						aria-describedby="emailHelp" 															
						placeholder="Enter email"
						required=true
					/>
				</div>	

				<div class="form-group">
					<label for="passwordInput">Password</label>
					<input 
						type="password"
						name="password" 
						class="form-control" 
						id="passwordInput" 
						aria-describedby="emailHelp" 															
						placeholder="Password"
						required=true
					/>
				</div>		

				<div class="form-group">
					<label for="phoneInput">Phone Number</label>
					<input 
						type="tel" 
						id="phoneInput" 
						name="phone"
						class="form-control" 
				        pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}"
				        placeholder="123-456-7890" 
				        required=true
				    />
				</div>
				
				<div class="form-group">
					<label for="exampleInputPassword1">Company</label>
					<input 
						name="company" 
						type="text" 
						class="form-control" 
						id="exampleInputPassword1" 
						placeholder="Company name"
					/>
				</div>
				<div class="form-group">
					<button onclick="submitData()" type="submit" class="btn btn-primary">Submit</button>
					<a class="btn btn-primary" href="contact_list.php">List of contacts</a>
				</div>				

			</form>
		</div>	
	</body>
</html>